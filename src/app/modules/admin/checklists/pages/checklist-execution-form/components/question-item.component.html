<div class="border dark:border-gray-600 rounded-lg p-4 space-y-4 bg-white dark:bg-gray-800 shadow-sm">
    <!-- Question Header -->
    <div class="flex items-start gap-3">
        <div class="flex-shrink-0 w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-sm font-medium text-blue-600 dark:text-blue-300">
            {{ question().sortOrder }}
        </div>
        <div class="flex-1">
            <h4 class="font-medium text-gray-900 dark:text-gray-100">
                {{ question().title }}
                @if (required()) {
                    <span class="text-red-500 dark:text-red-400 ml-1">*</span>
                }
            </h4>
            @if (question().description) {
                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">{{ question().description }}</p>
            }
            <div class="flex items-center gap-2 mt-2">
        <span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-xs text-gray-600 dark:text-gray-300">
          Peso: {{ (question().weight * 100).toFixed(0) }}%
        </span>
                <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900/30 rounded text-xs text-blue-600 dark:text-blue-300">
          {{ question().hasIntermediateApproval ? 'Sistema con intermedio' : 'Sistema simple' }}
        </span>
            </div>
        </div>
    </div>

    <!-- Compliance Status -->
    <div class="space-y-2">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">
            Estado de Cumplimiento
            @if (required()) {
                <span class="text-red-500 dark:text-red-400">*</span>
            }
        </label>
        <mat-radio-group formControlName="complianceStatus" class="flex gap-4 flex-wrap">
            <!-- Aprobado (siempre disponible) -->
            <mat-radio-button value="1.0" class="text-green-600 dark:text-green-400">
                <div class="flex items-center gap-2">
                    <mat-icon class="text-green-500 dark:text-green-400">check_circle</mat-icon>
                    <span>Aprobado (1.0)</span>
                </div>
            </mat-radio-button>

            <!-- Intermedio (solo si hasIntermediateApproval es true) -->
            @if (question().hasIntermediateApproval) {
                <mat-radio-button [value]="question().intermediateValue.toString()" class="text-orange-600 dark:text-orange-400">
                    <div class="flex items-center gap-2">
                        <mat-icon class="text-orange-500 dark:text-orange-400">remove_circle</mat-icon>
                        <span>Parcial ({{ question().intermediateValue.toFixed(2) }})</span>
                    </div>
                </mat-radio-button>
            }

            <!-- No Aprobado (siempre disponible) -->
            <mat-radio-button value="0.0" class="text-red-600 dark:text-red-400">
                <div class="flex items-center gap-2">
                    <mat-icon class="text-red-500 dark:text-red-400">cancel</mat-icon>
                    <span>No Aprobado (0.0)</span>
                </div>
            </mat-radio-button>
        </mat-radio-group>
    </div>

    <!-- Evidence Upload -->
    <div class="space-y-2">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">
            Evidencia
            <span class="text-gray-500 dark:text-gray-400 text-xs ml-1">(Opcional)</span>
        </label>
        <app-evidence-upload formControlName="evidenceFile"></app-evidence-upload>
    </div>

    <!-- Comment -->
    <div class="space-y-2">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">
            Comentario
            <span class="text-gray-500 dark:text-gray-400 text-xs ml-1">(Opcional)</span>
        </label>
        <mat-form-field class="w-full" appearance="outline">
      <textarea
          matInput
          formControlName="comment"
          rows="2"
          placeholder="Observaciones adicionales sobre esta pregunta..."
      ></textarea>
        </mat-form-field>
    </div>

    <!-- Question Status Indicator -->
    <div class="flex items-center justify-between pt-2 border-t border-gray-100">
        <div class="flex items-center gap-2 text-sm">
            @if (isCompleted()) {
                <mat-icon class="text-green-500 text-base">check_circle</mat-icon>
                <span class="text-green-600">Completada</span>
            } @else {
                <mat-icon class="text-gray-400 text-base">radio_button_unchecked</mat-icon>
                <span class="text-gray-500">Pendiente</span>
            }
        </div>

        @if (required() && !isCompleted()) {
            <span class="text-xs text-red-500 bg-red-50 px-2 py-1 rounded">
        Campo requerido
      </span>
        }
    </div>
</div>
